# Dock 状态信息展示增强计划

## 一、当前状态分析

### 1. Dock OSD 可用数据
从 Redis 中获取的 Dock OSD 数据包含以下字段：

| 字段 | 说明 | 当前是否展示 |
|------|------|--------------|
| `mode_code` | 机场模式 | ✅ 已展示 |
| `network_state.quality` | 网络质量 | ❌ 未展示 |
| `network_state.rate` | 网络速率 | ❌ 未展示 |
| `drone_in_dock` | 无人机在机场内 | ❌ 未展示 |
| `drone_charge_state.capacity_percent` | 无人机电量 | ❌ 未展示 |
| `environment_temperature` | 环境温度 | ❌ 未展示 |
| `temperature` | 机场内部温度 | ❌ 未展示 |
| `humidity` | 湿度 | ❌ 未展示 |
| `wind_speed` | 风速 | ❌ 未展示 |
| `rainfall` | 降雨量 | ❌ 未展示 |
| `cover_state` | 舱盖状态 | ❌ 未展示 |
| `alarm_state` | 告警状态 | ❌ 未展示 |

### 2. 当前问题
- 前端 `dockInfo` 数据来自 WebSocket `dock_osd` 消息
- WebSocket 连接存在但可能未正确接收消息
- 需要验证前端是否正确接收和处理 OSD 数据

## 二、实施计划

### 阶段 1：验证 WebSocket 数据流
1. 检查后端日志确认 WebSocket 消息推送
2. 检查前端控制台确认消息接收
3. 验证 `dockInfo` store 数据更新

### 阶段 2：增强前端展示
修改 `tsa.vue` 文件，在 Dock 面板中增加以下信息展示：

**布局设计**（在现有 RobotOutlined 行下方增加）：
```
┌─────────────────────────────────────┐
│ SimDock1 - Matrice 350 RTK          │  ← 设备名称
├─────────────────────────────────────┤
│ 🤖 Debugging     📡 网络质量: 5     │  ← 机场状态 + 网络质量
│ 🚁 Preparing     🔋 100%            │  ← 无人机状态 + 电量
├─────────────────────────────────────┤
│ 🌡️ 27.5°C  💧 59%  💨 2.9m/s       │  ← 温度/湿度/风速
│ 🌧️ 0mm     📦 舱盖:关闭  ⚠️ 无告警  │  ← 降雨/舱盖/告警
└─────────────────────────────────────┘
```

### 阶段 3：修改文件
1. **`front/src/types/device.ts`** - 更新 `DockBasicOsd` 接口定义
2. **`front/src/pages/page-web/projects/tsa.vue`** - 增加状态展示 UI

## 三、具体代码修改

### 1. 更新类型定义 (device.ts)
确保 `DockBasicOsd` 接口包含所有 OSD 字段

### 2. 增强 UI 展示 (tsa.vue)
在现有 Dock 面板中增加：
- 网络质量指示器
- 无人机在舱状态 + 电量
- 环境信息（温度、湿度、风速、降雨）
- 舱盖状态
- 告警状态

## 四、预期效果
- Dock 面板将显示完整的机场状态信息
- 实时更新（通过 WebSocket）
- 界面美观、信息清晰